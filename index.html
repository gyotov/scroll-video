<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<style>
  * {
    padding: 0;
    margin: 0;
  }

  .video-background {
    display: block;
    position: sticky;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    object-fit: cover;
  }

  #video-wrapper {
    position: relative;
  }

  #container {
    height: 100vh;
    margin-top: -100vh;
  }
</style>

<body>
  <div id="video-wrapper">
    <video src="./assets/processed_upload_105649685.mp4" playsinline="true" webkit-playsinline="true" preload="auto"
      muted="muted" class="video-background">
    </video>

    <div id="container"></div>
  </div>

  <script src="./assets/gsap.min.js"></script>
  <script src="./assets/ScrollTrigger.min.js"></script>
</body>

<script>
  const video = document.querySelector(".video-background");
  const container = document.querySelector('#container')
  const src = video.currentSrc || video.src;
  const speed = 400;

  function once(el, event, fn, opts) {
    const onceFn = function (e) {
      el.removeEventListener(event, onceFn);
      fn.apply(this, arguments);
    };
    el.addEventListener(event, onceFn, opts);
    return onceFn;
  }

  /* Make sure the video is 'activated' on iOS */
  once(document.documentElement, "touchstart", function (e) {
    video.play();
    video.pause();
  });

  once(video, "loadedmetadata", () => {
    /* Set container height based on video length and desired speed */
    container.style.height = (video.duration * speed) + 'px'

    gsap.registerPlugin(ScrollTrigger);

    const tl = gsap.timeline({
      defaults: { duration: 1 },
      scrollTrigger: {
        trigger: "#container",
        start: "top top",
        end: "bottom bottom",
        scrub: true,
        // markers: true
      }
    });

    tl.fromTo(
      video,
      { currentTime: 0 },
      { currentTime: video.duration || 1 }
    );
  });
</script>

</html>
