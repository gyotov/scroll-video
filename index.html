<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<style>
  .video-background {
    position: fixed;
    top: 50%;
    left: 50%;
    min-width: 100%;
    min-height: 100%;
    transform: translate(-50%, -50%);
  }

  #container {
    height: 500vh;
  }
</style>

<body>
  <video src="./assets/marble-video.mp4" playsinline="true" webkit-playsinline="true" preload="auto" muted="muted"
    class="video-background">
  </video>

  <div id="container"></div>

  <script src="./assets/gsap.min.js"></script>
  <script src="./assets/ScrollTrigger.min.js"></script>
</body>

<script>
  const video = document.querySelector(".video-background");
  const src = video.currentSrc || video.src;

  function once(el, event, fn, opts) {
    const onceFn = function (e) {
      el.removeEventListener(event, onceFn);
      fn.apply(this, arguments);
    };
    el.addEventListener(event, onceFn, opts);
    return onceFn;
  }

  /* Make sure the video is 'activated' on iOS */
  once(document.documentElement, "touchstart", function (e) {
    video.play();
    video.pause();
  });

  gsap.registerPlugin(ScrollTrigger);

  const tl = gsap.timeline({
    defaults: { duration: 1 },
    scrollTrigger: {
      trigger: "#container",
      start: "top top",
      end: "bottom bottom",
      scrub: true
    }
  });

  once(video, "loadedmetadata", () => {
    tl.fromTo(
      video,
      { currentTime: 0 },
      { currentTime: video.duration || 1 }
    );
  });
</script>

</html>
